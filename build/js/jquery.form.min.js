(function(t,e,i){"use strict";function s(t,e){this.DOMElement=t,this.parent=e,this.init()}function r(e,i){this.element=e,this.options=t.extend(!0,{},a,i),this._defaults=a,this._name=n,this.elements=[],this.init()}var n="Form",a={augmentHTML5:!0,customErrorMessage:!1,displayMessages:!0,listMessages:!0,listTitle:"We couldn't submit the form, please check your answers:",errorMessagesClass:"form-error-message",errorMessageElement:"p",errorMessages:{valueMissing:{text:"This field is required",email:"This field is required",tel:"This field is required",checkbox:"Check at least one of the required boxes",radio:"Select one of the required radio options"},patternMismatch:{tel:"Enter a valid phone number",email:"Enter a valid email address",text:"Please match the requested format"}},patterns:{email:"[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?",tel:"[\\w\\d\\s\\(\\)\\.+-]+"},fail:function(){},pass:!1};s.prototype={init:function(){this.ph="placeholder"in i.createElement("input"),this.type=t(this.DOMElement).attr("type")||"text",this.DOMElement.validityState=this.DOMElement.validityState||this.defaultValidityState(),this.DOMElement.checkValidity=this.DOMElement.checkValidity||this.getValidityState,this.ph||this.placeHolder()},defaultValidityState:function(){return{valid:!1,stepMismatch:!1,customError:!1,patternMismatch:!1,rangeOverflow:!1,rangeUnderflow:!1,tooLong:!1,typeMismatch:!1,valueMissing:!0}},getValidityState:function(){return this.validityState.valid},setValidityState:function(){var t,e=this.DOMElement.getAttribute("pattern")||this.parent.options.patterns[this.type],i=null;return""!==this.DOMElement.value&&("radio"!==this.type&&"checkbox"!==this.type||this.DOMElement.checked)?(this.DOMElement.validityState.valueMissing=!1,t=RegExp(e,""),t.test(this.DOMElement.value)?this.DOMElement.validityState.valid=!0:(this.DOMElement.validityState.valid=!1,this.DOMElement.validityState.patternMismatch=!0,i=this.parent.options.errorMessages.patternMismatch[this.type])):(this.DOMElement.validityState.valid=!1,this.DOMElement.validityState.valueMissing=!0,i=this.parent.options.errorMessages.valueMissing[this.type]),this.DOMElement.validationMessage=i,this},placeHolder:function(){var e=function(e){e.stopPropagation(),t(this).val().removeClass("form-placeholder")},i=function(e){e.stopPropagation(),""===t(this).val()&&(e.stopPropagation(),t(this).val(t(this).attr("placeholder")).addClass("form-placeholder"))};this.DOMElement.getAttribute("placeholder")&&(t(this.DOMElement).on("focus",e).on("blur",i,!1),""===t(this.DOMElement).val()&&t(this.DOMElement).val(t(this.DOMElement).attr("placeholder")).addClass("form-placeholder"))},clearPlaceholder:function(){return t(this.DOMElement).val()===t(this.DOMElement).attr("placeholder")&&t(this.DOMElement).val(""),this},validate:function(){var e=null;return t(this.DOMElement).val(),t(this.DOMElement).attr("pattern")||this.parent.options.patterns[this.type],this.ph||this.clearPlaceholder(),this.parent.HTML5||this.setValidityState(),e=this.DOMElement.checkValidity(),e?(("checkbox"===this.type||"radio"===this.type)&&(this.parent.groups[this.DOMElement.getAttribute("name")]="checked",this.parent.errors[this.DOMElement.getAttribute("name")]&&delete this.parent.errors[this.DOMElement.getAttribute("name")]),!1):this.parent.options.customErrorMessage?"radio"!==this.type&&"checkbox"!==this.type?this.DOMElement.validity.valueMissing&&this.parent.options.errorMessages.valueMissing[this.type]||this.DOMElement.validity.patternMismatch&&this.parent.options.errorMessages.patternMismatch[this.type]:"checked"!==this.parent.groups[this.DOMElement.getAttribute("name")]?(this.parent.groups[this.DOMElement.getAttribute("name")]="not-checked",this.parent.options.errorMessages.valueMissing[this.type]):void 0:this.DOMElement.validationMessage}},r.prototype={HTML5:!1,groups:[],init:function(){var e=this;this.HTML5="noValidate"in i.createElement("form"),(!this.HTML5||this.options.augmentHTML5)&&(t(this.element).find("input, textarea").each(function(){e.elements.push(new s(this,e))}),t(this.element).find("input[type=submit]").on("click",function(t){t.preventDefault(),e.clearErrors().test()}))},writeInline:function(e){var i=this;return t("<"+i.options.errorMessageElement+' role="alert"/>').addClass(i.options.errorMessagesClass).text(e)},clearErrors:function(){var e=this;return t(e.element).find(".form-error-list").length&&t(e.element).find(".form-error-list").remove(),t(e.element).find(".form-error").length&&(t(e.element).find(".form-error").removeClass("form-error"),t(e.element).find(".form-error-message").remove()),t(e.element).find("[aria-labelledBy]")&&t(e.element).find("[aria-labelledBy]").removeAttr("aria-labelledBy"),t(e.element).find("[aria-invalid]")&&t(e.element).find("[aria-invalid]").removeAttr("aria-invalidy"),this},listErrorMessages:function(){var e,i=this,s=t('<dl class="form-error-list"><dt>'+i.options.listTitle+"</dt><dd><ol></ol></dd></dl>");for(e in i.errors)i.errors.hasOwnProperty(e)&&"hasErrors"!==e&&t(s).find("ol").append("<li><a id="+e+"-error"+'" href="#'+i.errors[e].id+'">'+i.errors[e].error+"</a></li>");t(i.element).prepend(s),t("html, body").animate({scrollTop:t(s).offset().top},500),s.focus()},displayInlineErrorMessages:function(){var e=this,s=null,r=null,n=null,a=null,o=null;console.log("To do\n - test displaying of inline errors");for(s in e.errors)e.errors.hasOwnProperty(s)&&"hasErrors"!==s&&(a=e.writeInline(e.errors[s].error),r=null!==i.getElementById(s)?i.getElementById(e.errors[s].id):i.getElementsByName(s)[0],o=e.errors[s].id+"-error",a.setAttribute("id",o),r.setAttribute("aria-labelledBy",o),n=r.parentNode,0===n.getElementsByClassName(e.options.errorMessagesClass).length&&n.insertBefore(a,r.nextSibling));t("html, body").animate({scrollTop:t(this.element).offset().top},50),i.getElementsByClassName(e.options.errorMessagesClass)[0].focus()},addError:function(e,i,s){var r=this,n=e,a=null,o=null,l=null;a=s?t(n).attr("name"):t(n).attr("id"),o=t(n).attr("id"),l=s?n.parentNode:n,t(l).addClass("form-error"),t(n).attr("aria-invalid","true"),r.errors.hasErrors=!0,r.errors[a]={error:i,id:o}},test:function(){var e=null,i=null,s=null,r=null,n=this.elements.length,a=this;for(console.log(this),this.errors={},this.groups=[],e=0;n>e;e+=1)i=this.elements[e].DOMElement,"submit"!==i.getAttribute("type")&&null!==i.getAttribute("required")&&"hidden"!==i.getAttribute("type")&&null===i.getAttribute("novalidate")&&(s=this.elements[e].validate(),s&&(a.addError(this.elements[e].DOMElement,s,"checkbox"===this.elements[e].type||"radio"===this.elements[e].type),this.elements[e].ph||this.elements[e].placeHolder()));this.errors.hasErrors?(a.options.displayMessages&&(a.options.listMessages?a.listErrorMessages():a.displayInlineErrorMessages()),this.options.fail.call()):r=this.options.pass?this.options.pass.call():t(this.element).submit()}},t.fn[n]=function(e){return this.each(function(){t.data(this,"plugin_"+n)||t.data(this,"plugin_"+n,new r(this,e))})}})(jQuery,window,document,void 0);
