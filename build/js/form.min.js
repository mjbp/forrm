(function(t,e,i){"use strict";"function"==typeof define&&define.amd?define(i):e[t]=i()})("Form",this,function(t,e){"use strict";function i(t,e){var s=null;for(s in e)e.hasOwnProperty(s)&&(e[s]&&e[s].constructor&&e[s].constructor===Object?(t[s]=t[s]||{},i(t[s],e[s])):t[s]=e[s]);return t}function s(t,e){this.DOMElement=t,this.parent=e,this.init()}function r(t,e){if("undefined"===t)throw Error("Nae name");this.name=t,this.elements=e,this.parent=e[0].parent,this.init(e)}function a(t){if("undefined"===t)throw Error("Nae form");this.parent=t,this.init()}function n(t,e){if("undefined"===t)throw Error("Nae element");this.DOMElement=t,this.options=i(l,e),this.init()}t=t||"Form",e=e||this;var l={augmentHTML5:!0,customErrorMessage:!0,displayMessages:!0,successClass:"form-success",errorClass:"form-error",listMessages:!1,listTitle:"We couldn't submit the form, please check your answers:",errorMessagesClass:"form-error-message",errorMessageElement:"p",errorMessages:{text:{valueMissing:"This field is required",patternMismatch:"Match the requested format"},url:{valueMissing:"This field is required",patternMismatch:"Enter a valid URL",typeMismatch:"Enter a valid URL"},search:{valueMissing:"This field is required",patternMismatch:"Match the requested format"},email:{valueMissing:"This field is required",patternMismatch:"Enter a valid email address",typeMismatch:"Enter a valid email address"},tel:{valueMissing:"This field is required",patternMismatch:"Enter a valid phone number"},select:{valueMissing:"Choose an option"},checkbox:{valueMissing:"Check at least one of the required boxes"},radio:{valueMissing:"Select one of the required radio options"},number:{valueMissing:"This field is required",patternMismatch:"Enter a valid number",typeMismatch:"Enter a valid number"},file:{valueMissing:"Choose a file"}},patterns:{email:"[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?",tel:"[\\w\\d\\s\\(\\)\\.+-]+"},fail:function(){},pass:!1};return s.prototype={init:function(){var t,e=this,i=function(){e.parent.liveValidating&&(e.parent.validationList[e.errorGroup].element.validate(),e.parent.options.listMessages?e.parent.UI.listErrorMessages():e.parent.UI.updateInlineErrors(e))};this.type="input"===this.DOMElement.tagName.toLowerCase()&&this.DOMElement.getAttribute("type")||this.DOMElement.tagName.toLowerCase(),this.errorGroup=this.DOMElement.getAttribute("id"),this.validityState=this.DOMElement.validityState||this.defaultValidityState(),t=("checkbox"===this.type||"radio"===this.type||"file"===this.type)&&"change"||"input",this.DOMElement.addEventListener(t,i,!1)},defaultValidityState:function(){return{valid:!1,stepMismatch:!1,customError:!1,patternMismatch:!1,rangeOverflow:!1,rangeUnderflow:!1,tooLong:!1,typeMismatch:!1,valueMissing:!0}},getValidityState:function(){return this.validityState.valid},setValidityState:function(){var t,e=this.DOMElement.getAttribute("pattern")||this.parent.options.patterns[this.type];return this.validationMessage=null,""!==this.DOMElement.value.replace(/^\s+/g,"").replace(/\s+$/g,"")&&("radio"!==this.type&&"checkbox"!==this.type||this.DOMElement.checked)?(this.validityState.valueMissing=!1,t=RegExp(e,""),t.test(this.DOMElement.value)?this.validityState.valid=!0:(this.validityState.valid=!1,"text"===this.type?this.validityState.patternMismatch=!0:this.validityState.typeMismatch=!0,this.validationMessage=this.parent.options.errorMessages[this.type].patternMismatch)):(this.validityState.valid=!1,this.validityState.valueMissing=!0,this.validationMessage=this.parent.options.errorMessages[this.type].valueMissing),this},setGroup:function(t){return this.group=t,this.errorGroup=t.name,this.validate=t.validate,this},addError:function(t){return this.DOMElement.className=this.DOMElement.className.split(" "+this.parent.options.successClass).join(""),-1===this.DOMElement.className.indexOf(this.parent.options.errorClass)&&(this.DOMElement.className+=" "+this.parent.options.errorClass),this.DOMElement.setAttribute("aria-invalid","true"),this.parent.manageValidationList(this.errorGroup,t),this},removeError:function(){return this.DOMElement.className=this.DOMElement.className.split(" "+this.parent.options.errorClass).join(""),this.DOMElement.setAttribute("aria-invalid","false"),this.DOMElement.removeAttribute("aria-labelledby"),this.parent.manageValidationList(this.errorGroup,null),this},addSuccess:function(){return this.removeError(),-1===this.DOMElement.className.indexOf(this.parent.options.successClass)&&(this.DOMElement.className+=" "+this.parent.options.successClass),this},validate:function(){var t;this.parent.HTML5||this.setValidityState(),t=this.DOMElement.checkValidity?this.DOMElement.checkValidity():this.getValidityState(),t?this.addSuccess():this.addError(this.getError())},getError:function(){return this.parent.options.customErrorMessage?this.parent.options.errorMessages[this.type][this.validityState.valueMissing&&"valueMissing"||this.validityState.patternMismatch&&"patternMismatch"||this.validityState.typeMismatch&&"typeMismatch"]:this.DOMElement.validationMessage||this.validationMessage}},r.prototype={init:function(){this.valid=!0},addError:function(t){for(var e=0;this.elements.length>e;e++)-1===this.elements[e].DOMElement.parentElement.className.indexOf(" "+this.parent.options.errorClass)&&(this.elements[e].DOMElement.parentElement.className+=" "+this.parent.options.errorClass),this.elements[e].DOMElement.setAttribute("aria-invalid","true");return this.parent.manageValidationList(this.name,t),this},removeError:function(){for(var t=0;this.elements.length>t;t++)this.elements[t].DOMElement.setAttribute("aria-invalid","false"),this.elements[t].DOMElement.removeAttribute("aria-labelledby"),this.elements[t].DOMElement.parentNode.className=this.elements[t].DOMElement.parentNode.className.split(" "+this.parent.options.errorClass).join("");this.parent.manageValidationList(this.name,null)},validate:function(){for(var t,e=null,i=0;this.elements.length>i;i++){if(this.parent.HTML5||this.elements[i].setValidityState(),t=this.elements[i].DOMElement.checkValidity?this.elements[i].DOMElement.checkValidity():this.elements[i].getValidityState())return this.valid=!0,this.removeError(),void 0;this.valid&&(this.valid=!1,e=this.elements[i].getError())}e&&this.addError(e)},getName:function(){return this.name}},a.prototype={init:function(){this.write=this.parent.options.displayMessages?this.parent.options.listMessages?this.listErrorMessages:this.displayInlineErrorMessages:function(){return this}},addInlineError:function(t){var e,i=document.createElement(this.parent.options.errorMessageElement);i.textContent=this.parent.validationList[t].error,i.className=this.parent.options.errorMessagesClass,i.setAttribute("role","alert"),i.setAttribute("id",t+"-error"),e=document.getElementById(t)||document.getElementsByName(t)[0],e.setAttribute("aria-labelledBy",t+"-error"),e.parentNode.insertBefore(i,e.nextSibling)},clearInlineErrors:function(){var t=this.parent.DOMElement.querySelectorAll(".form-error-message");if(0!==t.length){for(var e=0;t.length>e;e++)t[e].parentNode.removeChild(t[e]);return this}},updateInlineErrors:function(t){var e=document.getElementById(t.DOMElement.getAttribute("id")+"-error")||document.getElementById(t.DOMElement.getAttribute("name")+"-error");return t.parent.validationList[t.errorGroup].error?e?(e.textContent=t.parent.validationList[t.errorGroup].error,this):(this.addInlineError(t.errorGroup),this):e?(e.parentNode.removeChild(e),this):this},displayInlineErrorMessages:function(){this.clearInlineErrors();for(var t in this.parent.validationList)this.parent.validationList.hasOwnProperty(t)&&"countErrors"!==t&&this.parent.validationList[t].error&&this.addInlineError(t)},listErrorMessages:function(){var t=this.parent.DOMElement.querySelector(".form-error-list"),e=document.createElement("dl"),i=document.createElement("dt"),s=document.createElement("dd"),r=document.createElement("ol"),a=document.createElement("li"),n=document.createElement("a"),l=null,o=null;if(this.errorListHolder=e,t&&t.parentElement.removeChild(t),0===this.parent.validationList.countErrors)return this;i.innerHTML=this.parent.options.listTitle,e.appendChild(i),e.appendChild(s),e.className="form-error-list",e.setAttribute("role","alert"),s.appendChild(r);for(var h in this.parent.validationList)this.parent.validationList.hasOwnProperty(h)&&"countErrors"!==h&&this.parent.validationList[h].error&&(l=a.cloneNode(!0),o=n.cloneNode(!0),o.setAttribute("href","#"+this.parent.validationList[h].id),o.setAttribute("id",h+"-error"),o.innerHTML=this.parent.validationList[h].error,l.appendChild(o),r.appendChild(l));this.parent.DOMElement.insertBefore(e,this.parent.DOMElement.firstChild)}},n.prototype={HTML5:!1,groups:{},init:function(){var t=[];if(this.HTML5="noValidate"in document.createElement("form"),this.liveValidating=!1,!this.HTML5||this.options.augmentHTML5){this.fields=this.DOMElement.querySelectorAll("input, textarea, select"),this.validatebleElements={},this.DOMElement.querySelector("input[type=submit]").addEventListener("click",this,!1),this.DOMElement.querySelector("input[type=submit]").addEventListener("onkeypress",this,!1);for(var e=0;this.fields.length>e;e+=1)if("submit"!==this.fields[e].getAttribute("type")&&"reset"!==this.fields[e].getAttribute("type")&&"button"!==this.fields[e].getAttribute("type")&&null!==this.fields[e].getAttribute("required")&&"hidden"!==this.fields[e].getAttribute("type")&&null===this.fields[e].getAttribute("novalidate")&&(this.validatebleElements[this.fields[e].getAttribute("id")]=new s(this.fields[e],this),("checkbox"===this.fields[e].getAttribute("type")||"radio"===this.fields[e].getAttribute("type"))&&t.push(this.validatebleElements[this.fields[e].getAttribute("id")]),(this.fields[e].getAttribute("name")!==this.fields[e+1].getAttribute("name")||e-1===this.fields.length)&&t.length>0)){this.groups[this.fields[e].getAttribute("name")]=new r(this.fields[e].getAttribute("name"),t);for(var i=0;t.length>i;i++)t[i].setGroup(this.groups[this.fields[e].getAttribute("name")]);t=[]}this.UI=new a(this),this.makeValidationList()}},handleEvent:function(t){(!this.HTML5||this.options.augmentHTML5)&&(this.liveValidating=!0,("click"===t.type||"onkeypress"===t.type)&&(t.preventDefault(),this.test()))},makeValidationList:function(){this.validationList={};for(var t in this.validatebleElements)this.validatebleElements.hasOwnProperty(t)&&(this.validationList[this.validatebleElements[t].errorGroup]={error:null,element:this.groups[this.validatebleElements[t].errorGroup]||this.validatebleElements[t],id:this.groups[this.validatebleElements[t].errorGroup]?document.getElementsByName(this.validatebleElements[t].errorGroup)[0].getAttribute("id"):document.getElementById(this.validatebleElements[t].errorGroup).getAttribute("id")});return this.validationList.countErrors=0,this},manageValidationList:function(t,e){return e?null===this.validationList[t].error&&(this.validationList.countErrors+=1):this.validationList.countErrors>0&&(this.validationList.countErrors-=1),this.validationList[t].error=e,this},test:function(){var t=null,e=(this.validatebleElements.length,this);this.makeValidationList();for(var i in this.validationList)this.validationList.hasOwnProperty(i)&&"countErrors"!==i&&this.validationList[i].element.validate();this.validationList.countErrors>0?(e.UI.write(),this.options.listMessages?(window.scrollTo(0,this.UI.errorListHolder.offsetTop),this.UI.errorListHolder.focus()):(window.scrollTo(0,this.DOMElement.offsetTop),document.getElementsByClassName(this.options.errorMessagesClass)[0].focus()),this.options.fail.call()):t=this.options.pass?this.options.pass.call():this.DOMElement.submit()}},{init:function(t,e){var i=document.querySelectorAll(t),s=[],r=null,a=i.length;for(r=0;a>r;r+=1)i[r].hasAttribute("novalidate")||(s[r]=new n(i[r],e))}}});
