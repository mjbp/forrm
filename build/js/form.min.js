(function(e,t,r){"use strict";"function"==typeof define&&define.amd?define(r):t[e]=r()})("Form",this,function(e,t){"use strict";function r(e,t){var s;for(s in t)t.hasOwnProperty(s)&&(t[s]&&t[s].constructor&&t[s].constructor===Object?(e[s]=e[s]||{},r(e[s],t[s])):e[s]=t[s]);return e}function s(e,t){this.element=e,this.options=r(o,t),this.init()}e=e||"Form",t=t||this;var o={displayMessages:!0,listMessages:!0,listTitle:"Errors were found in the form:",errorMessagesClass:"form-error-message",errorMessageElement:"p",errorMessages:{required:"Fields marked * are required",tel:"Enter a valid phone number",dob:"Enter a valid date of birth",email:"Enter a valid email address"},patterns:{email:"[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?",tel:"[\\w\\d\\s\\(\\)\\.+-]+"},fail:function(){},pass:!1};return s.prototype={init:function(){this.fields=this.element.querySelectorAll("input, textarea"),this.element.querySelector("input[type=submit]").addEventListener("click",this,!1)},handleEvent:function(e){"click"===e.type&&(e.preventDefault(),this.clearErrors().test())},write:function(e){var t=this,r=document.createElement(t.options.errorMessageElement);return r.textContent=e,r.className=t.options.errorMessagesClass,r.setAttribute("role","alert"),r},clearErrors:function(){var e,t,r=this,s=r.fields.length;for(t=0;s>t;t+=1)r.fields[t].className.indexOf("form-error")>-1&&(r.fields[t].className=r.fields[t].className.split("form-error").join(""),r.options.listMessages||(e=r.fields[t].nextElementSibling,e&&e.parentNode.removeChild(e)));return r},listErrorMessages:function(){var e,t,r=this,s=document.querySelector(".form-error-list"),o=document.createElement("dl"),i=document.createElement("dt"),n=document.createElement("dd"),a=document.createElement("ul"),l=r.errors.length,d={};for(s&&s.parentElement.removeChild(s),i.innerHTML=r.options.listTitle,o.appendChild(i),o.appendChild(n),o.className="form-error-list",o.setAttribute("role","alert"),n.appendChild(a),e=0;l>e;e+=1)d[r.errors[e][1]]=r.options.errorMessages[r.errors[e][1]];for(e in d)d.hasOwnProperty(e)&&(t=document.createElement("li"),t.innerHTML=d[e],a.appendChild(t));r.element.insertBefore(o,r.element.firstChild),window.scrollTo(0,o.offsetTop),o.focus()},displayErrorMessages:function(){var e,t,r,s,o=this,i=o.errors.length;for(e=0;i>e;e+=1)s=o.write(o.options.errorMessages[o.errors[e][1]]),t=null!==document.getElementById(o.errors[e][0])?document.getElementById(o.errors[e][0]):document.getElementsByName(o.errors[e][0])[0],r=t.parentNode,0===r.getElementsByClassName(o.options.errorMessagesClass).length&&r.insertBefore(s,t.nextSibling);window.scrollTo(0,document.getElementsByClassName(o.options.errorMessagesClass)[0].offsetTop),document.getElementsByClassName(o.options.errorMessagesClass)[0].focus()},addError:function(e,t,r){var s,o,i=this,n=e;s=r?n.getAttribute("name"):n.getAttribute("id"),o=r?n.parentNode:n,o.className+=" form-error",n.setAttribute("aria-invalid","true"),i.errors.push([s,t])},test:function(){var e,t,r,s,o,i,n,a,l,d=this,u={};for(this.errors=[],n=d.fields.length,o=0;n>o;o+=1)e=d.fields[o],"hidden"!==e.getAttribute("type")&&null===e.getAttribute("novalidate")&&"submit"!==e.getAttribute("type")&&null!==e.getAttribute("required")&&(""===e.value?d.addError(e,"required"):"radio"===e.getAttribute("type")||"checkbox"===e.getAttribute("type")?e.checked?u[e.getAttribute("name")]="checked":"checked"!==u[e.getAttribute("name")]&&(u[e.getAttribute("name")]="not-checked"):(t=e.getAttribute("type"),r=e.getAttribute("pattern")||d.options.patterns[t],void 0!==r&&(s=RegExp(r,""),s.test(e.value)||d.addError(e,t))));for(o in u)if(u.hasOwnProperty(o)&&"not-checked"===u[o])for(a=document.getElementsByName(o),i=0;a.length>i;i+=1)d.addError(a[i],"required",!0);d.errors.length?(d.options.displayMessages&&(d.options.listMessages?d.listErrorMessages():d.displayErrorMessages()),this.options.fail.call()):l=this.options.pass?this.options.pass.call():this.element.submit()}},{init:function(e,t){var r,o=document.querySelectorAll(e),i=[],n=o.length;for(r=0;n>r;r+=1)o[r].hasAttribute("novalidate")||(i[r]=new s(o[r],t))}}});