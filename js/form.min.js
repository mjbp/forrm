(function(e,t,r){"use strict";"function"==typeof define&&define.amd?define(r):t[e]=r()})("Form",this,function(e,t){"use strict";function r(e,t){var s;for(s in t)t.hasOwnProperty(s)&&(t[s]&&t[s].constructor&&t[s].constructor===Object?(e[s]=e[s]||{},r(e[s],t[s])):e[s]=t[s]);return e}function s(e,t){this.element=e,this.options=r(i,t),this.init()}e=e||"Form",t=t||this;var i={displayMessages:!0,listMessages:!0,listTitle:"Errors were found in the form:",errorMessagesClass:"form-error-message",errorMessageElement:"p",errorMessages:{required:"Fields marked * are required",tel:"Enter a valid phone number",dob:"Enter a valid date of birth",email:"Enter a valid email address"},patterns:{email:"[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?",tel:"[\\w\\d\\s\\(\\)\\.+-]+"},fail:function(){},pass:!1};return s.prototype={init:function(){this.fields=this.element.querySelectorAll("input, textarea"),this.element.querySelector("input[type=submit]").addEventListener("click",this,!1),this.placeHolders()},clearPlaceholders:function(){var e,t=this.fields.length;for(e=0;t>e;e+=1)this.fields[e].getAttribute("placeholder")&&(this.fields[e].value="");return this},placeHolders:function(){var e,t="placeholder"in document.createElement("input"),r=this.fields.length,s=function(){this.value="",this.className=this.className.split("form-placeholder").join("")},i=function(){console.log(this),this.value=this.getAttribute("placeholder"),this.className+=" form-placeholder"};if(t)for(e=0;r>e;e+=1)this.fields[e].getAttribute("placeholder")&&(this.fields[e].value=this.fields[e].getAttribute("placeholder"),this.fields[e].className+="form-placeholder",this.fields[e].addEventListener("focus",s,!1),this.fields[e].addEventListener("blur",i,!1))},handleEvent:function(e){"click"===e.type&&(e.preventDefault(),this.clearErrors().test())},write:function(e){var t=this,r=document.createElement(t.options.errorMessageElement);return r.textContent=e,r.className=t.options.errorMessagesClass,r.setAttribute("role","alert"),r},clearErrors:function(){var e,t,r=this,s=r.fields.length;for(t=0;s>t;t+=1)r.fields[t].parentNode.className.indexOf("form-error")>-1&&(r.fields[t].parentNode.className=r.fields[t].parentNode.className.split("form-error").join(""),r.options.listMessages||(e=r.fields[t].nextElementSibling,e&&e.parentNode.removeChild(e)));return r},listErrorMessages:function(){var e,t,r=this,s=document.querySelector(".form-error-list"),i=document.createElement("dl"),o=document.createElement("dt"),n=document.createElement("dd"),l=document.createElement("ul"),a=r.errors.length,d={};for(s&&s.parentElement.removeChild(s),o.innerHTML=r.options.listTitle,i.appendChild(o),i.appendChild(n),i.className="form-error-list",i.setAttribute("role","alert"),n.appendChild(l),e=0;a>e;e+=1)d[r.errors[e][1]]=r.options.errorMessages[r.errors[e][1]];for(e in d)d.hasOwnProperty(e)&&(t=document.createElement("li"),t.innerHTML=d[e],l.appendChild(t));r.element.insertBefore(i,r.element.firstChild),window.scrollTo(0,i.offsetTop),i.focus()},displayErrorMessages:function(){var e,t,r,s,i=this,o=i.errors.length;for(e=0;o>e;e+=1)s=i.write(i.options.errorMessages[i.errors[e][1]]),t=null!==document.getElementById(i.errors[e][0])?document.getElementById(i.errors[e][0]):document.getElementsByName(i.errors[e][0])[0],r=t.parentNode,0===r.getElementsByClassName(i.options.errorMessagesClass).length&&r.insertBefore(s,t.nextSibling);window.scrollTo(0,document.getElementsByClassName(i.options.errorMessagesClass)[0].offsetTop),document.getElementsByClassName(i.options.errorMessagesClass)[0].focus()},addError:function(e,t,r){var s,i,o=this,n=e;s=r?n.getAttribute("name"):n.getAttribute("id"),i=r?n.parentNode:n,i.className+=" form-error",n.setAttribute("aria-invalid","true"),o.errors.push([s,t])},test:function(){var e,t,r,s,i,o,n,l,a,d=this,c={};for(this.errors=[],n=d.fields.length,i=0;n>i;i+=1)e=d.fields[i],"hidden"!==e.getAttribute("type")&&null===e.getAttribute("novalidate")&&"submit"!==e.getAttribute("type")&&null!==e.getAttribute("required")&&(""===e.value?d.addError(e,"required"):"radio"===e.getAttribute("type")||"checkbox"===e.getAttribute("type")?e.checked?c[e.getAttribute("name")]="checked":"checked"!==c[e.getAttribute("name")]&&(c[e.getAttribute("name")]="not-checked"):(t=e.getAttribute("type"),r=e.getAttribute("pattern")||d.options.patterns[t],void 0!==r&&(s=RegExp(r,""),s.test(e.value)||d.addError(e,t))));for(i in c)if(c.hasOwnProperty(i)&&"not-checked"===c[i])for(l=document.getElementsByName(i),o=0;l.length>o;o+=1)d.addError(l[o],"required",!0);d.errors.length?(d.options.displayMessages&&(d.options.listMessages?d.listErrorMessages():d.displayErrorMessages()),this.options.fail.call()):a=this.options.pass?this.options.pass.call():this.element.submit()}},{init:function(e,t){var r,i=document.querySelectorAll(e),o=[],n=i.length;for(r=0;n>r;r+=1)i[r].hasAttribute("novalidate")||(o[r]=new s(i[r],t))}}});